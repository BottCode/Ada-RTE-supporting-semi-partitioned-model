<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Scenario 2</title>
        <style>
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-light">
        <h1 id="scenario-2">Scenario 2</h1>
<p>Questo scenario, costruito a partire dallo <a href="../scenario_1/scenario_1.html">scenario 1</a>, riguarda il rappresentare e il rilevare l'<strong>overrun</strong> di un task.
L'overrun di un task si verifica quando esso esegue sulla CPU per oltre una quantità temporale prestabilita (<em>budget</em>).</p>
<p>Bisogna:</p>
<ul class="contains-task-list">
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> rappresentare il budget di un task.
<ul class="contains-task-list">
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> deve essere espresso in microsecondi.</li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> deve essere compreso nella specifica di un task.</li>
</ul>
<pre><code><code><div>   task type Periodic_First_CPU
   (Pri    : System.Priority;
    Budget : Ada.Real_Time.Microseconds
    Period : Positive) with CPU =&gt; 1
  is
    pragma Priority (Pri);
 end Periodic_First_CPU;
</div></code></code></pre>
<ul class="contains-task-list">
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> un budget pari a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> (zero) rappresenta un task il quale tempo di esecuzione non è soggetto a monitoraggio.</li>
</ul>
</li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> impostarlo prima dell'esecuzione del corpo del task, ovvero all'interno della sua <em>regione dichiarativa</em>.
<ul>
<li>questo implica che il descrittore di quel task dovrà contenere un campo relativo al suo budget.</li>
</ul>
</li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> forzare il task ad eseguire per oltre il suo budget, così da ricreare un overrun.</li>
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> al verificarsi dell'overrun deve essere invocato un apposito gestore (<em>handler</em> <code>Overrun_Detected</code>) che scrive sulla porta seriale (UART) &quot;Overrun detected&quot;. Tale handler <strong>deve</strong> eseguire sullo stesso core sul quale l'overrun è stato osservato (per ora il core0). Questo implica che l'handler deve prendere il possesso del core a discapito del task che ha ecceduto il suo budget. Siano:
<ul>
<li><code>t</code>, l'istante <em>assoluto</em> nel tempo nel quale il task <code>P1</code> (ri-)prende possesso del core</li>
<li><code>x</code>, la quantità temporale corrispondente al budget di P1</li>
<li>allora, nell'istante <code>t</code>:
<ul class="contains-task-list">
<li class="task-list-item">
<p><input class="task-list-item-checkbox" disabled="" type="checkbox"> deve essere armato un evento temporale al punto temporale <em>assoluto</em> <code>t+x</code> non appena <code>P1</code> prende possesso del core.</p>
<ul>
<li>al netto di problemi di ordine di elaborazione, il package <code>Ada.Real_Time.Timing_Events</code> è utile in tal senso.</li>
</ul>
</li>
<li class="task-list-item">
<p><input class="task-list-item-checkbox" disabled="" type="checkbox"> se il task perde il possesso del core a causa di</p>
<ul>
<li><s><em>preemption</em> da parte di un task <em>ready</em> a priorità più alta</s>. Non può accadere in questo scenario in quanto esiste solo il task <code>P1</code>.</li>
<li>esecuzione dell'istruzione di <code>delay_until</code></li>
</ul>
<p>allora l'evento temporale deve essere <strong>disarmato</strong>. In generale, il disarmo deve avvenire ogni volta che il task perde/cede il core.</p>
</li>
<li class="task-list-item">
<p><input class="task-list-item-checkbox" disabled="" type="checkbox"> se nel punto temporale assoluto <code>t+x</code> il task è ancora in esecuzione sul core, allora vuol dire che che il task sta eseguendo oltre il suo budget =&gt; <strong>overrun</strong>. Nella pratica, visto quanto detto al punto precedente, l'overrun si verifica <strong>solo ed esclusivamente</strong> se il disarmo dell'evento temporale non avviene in tempo o non correttamente. &quot;Dimenticare&quot; un disarmo causerebbe la rilevazione di un overrun fasullo, cosa che chiaramente non deve accadere.  Il verificarsi di tale evento temporale corrisponde all'esecuzione dell'handler <code>Overrun_Detected</code></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>

    </body>
    </html>